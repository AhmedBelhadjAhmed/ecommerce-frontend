import{a as Q}from"./chunk-Z7JX7RS7.js";import{a as K}from"./chunk-3E2XEZQ5.js";import{a as ie}from"./chunk-KACECMBE.js";import{a as V,b as g,c as D,d as R,f as k,g as q,h as G,i as B,j as L,k as z,l as U,m as $,n as X,o as H,q as J}from"./chunk-WMSCIBPS.js";import{a as W}from"./chunk-VR3MZZWK.js";import{a as T}from"./chunk-ZH3L7T54.js";import{k as O,o as _}from"./chunk-MLHW3EEE.js";import{$ as x,Ba as s,Ca as p,Oa as u,Ra as c,S as v,Ta as r,Ua as o,Ub as M,Va as m,Vb as j,Wa as I,Xa as f,Ya as h,Zb as y,aa as b,db as a,e as te,eb as N,ha as P,ia as w,lb as A,ya as E}from"./chunk-5XN3BUNB.js";var F=te(ie());function re(i,t){if(i&1&&(r(0,"option",23),a(1),o()),i&2){let e=t.$implicit;c("value",e._id),s(),N(e.name)}}function oe(i,t){if(i&1){let e=I();r(0,"div",27)(1,"div",28),m(2,"img",29),r(3,"button",30),f("click",function(){let d=P(e).index,l=h(2);return w(l.removeImage(d))}),a(4,"X"),o()()()}if(i&2){let e=t.$implicit;s(2),c("src",e,E)}}function ne(i,t){if(i&1&&(r(0,"div",24)(1,"div",25),u(2,oe,5,1,"div",26),o()()),i&2){let e=h();s(2),c("ngForOf",e.imagePreviews)}}function ae(i,t){if(i&1&&(r(0,"button",31),a(1," Create Product "),o()),i&2){let e=h();c("disabled",e.myForm.invalid)}}function ce(i,t){i&1&&(r(0,"div",32)(1,"div",33)(2,"span",34),a(3,"Loading..."),o()()())}var S=class i{constructor(t,e,n,d){this.categoryService=t;this.formBuilder=e;this.productService=n;this.router=d;this.myForm=this.formBuilder.group({name:["",[g.required]],price:["",[g.required,g.min(1)]],description:[""],category:["",g.required],images:[""]})}myForm;categories=[];categorySubscription;productSubscription;imagePreviews=[];selectedFiles=[];fileInput;loading=!1;ngOnInit(){this.getCategories()}ngOnDestroy(){this.categorySubscription&&this.categorySubscription.unsubscribe(),this.productSubscription&&this.productSubscription.unsubscribe()}getCategories(){this.categorySubscription=this.categoryService.getCategories().subscribe({next:t=>{this.categories=t,this.categories.length>0&&this.myForm.controls.category.setValue(this.categories[0]._id)},error:t=>{console.error("Error fetching categories",t)}})}onImageSelected(t){this.fileInput=t.target;let e=t.target.files;this.imagePreviews=[],this.selectedFiles=[];for(let n=0;n<e.length&&n<10;n++){let d=e[n];this.selectedFiles.push(d);let l=new FileReader;l.onload=ee=>{this.imagePreviews.push(ee.target.result)},l.readAsDataURL(d)}}removeImage(t){this.imagePreviews.splice(t,1),this.selectedFiles.splice(t,1);let e=new DataTransfer;this.selectedFiles.forEach(n=>e.items.add(n)),this.fileInput.files=e.files}onCategoryChanged(t){this.myForm.controls.category.setValue(t.target.value)}onSubmit(){this.myForm.valid?this.createProduct():console.log("Form is not valid")}createProduct(){let t=new FormData;t.append("name",this.myForm.value.name),t.append("price",this.myForm.value.price),t.append("description",this.myForm.value.description),t.append("category",this.myForm.value.category),this.selectedFiles.forEach(e=>{t.append("images",e)}),this.loading=!0,this.productSubscription=this.productService.createProduct(t).subscribe({next:e=>{this.loading=!1,F.default.fire({icon:"success",title:"Product created successfully",timer:1500}).then(()=>{this.router.navigate(["/listProducts"])})},error:e=>{this.loading=!1,F.default.fire({icon:"error",title:"Error",text:e.error.message,timer:1500})}})}static \u0275fac=function(e){return new(e||i)(p(K),p(H),p(Q),p(O))};static \u0275cmp=x({type:i,selectors:[["app-add-products"]],standalone:!0,features:[A],decls:41,vars:5,consts:[[1,"container-fluid","p-0"],[1,"row","no-gutters"],[1,"col-12"],[1,"col-2"],[1,"col-10",2,"margin-top","70px"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","name",1,"form-label"],[1,"col-md-6"],["id","name","type","text","formControlName","name","placeholder","Enter product name","required","",1,"form-control"],["for","price",1,"form-label"],["id","price","type","number","formControlName","price","placeholder","Enter price","min","1","required","",1,"form-control"],["for","description",1,"form-label"],["id","description","rows","3","formControlName","description","placeholder","Enter product description",1,"form-control"],["for","category",1,"form-label"],["id","category","formControlName","category",1,"form-control",3,"change"],[3,"value",4,"ngFor","ngForOf"],["for","images",1,"form-label"],["id","images","type","file","accept","image/*","multiple","",1,"form-control",3,"change"],["class","form-group mt-3",4,"ngIf"],[1,"d-flex","justify-content-center","align-items-center","mt-3"],["type","submit","class","btn btn-success","style","background-color: #4CAF50; border: none; width: 200px;",3,"disabled",4,"ngIf"],["class","d-flex justify-content-center align-items-center","style","width: 200px; height: 40px;",4,"ngIf"],[3,"value"],[1,"form-group","mt-3"],[1,"row"],["class","col-md-2",4,"ngFor","ngForOf"],[1,"col-md-2"],[1,"position-relative"],["alt","Selected image preview",1,"img-thumbnail",3,"src"],["type","button",1,"btn","btn-remove","position-absolute","top-0","start-100","translate-middle",3,"click"],["type","submit",1,"btn","btn-success",2,"background-color","#4CAF50","border","none","width","200px",3,"disabled"],[1,"d-flex","justify-content-center","align-items-center",2,"width","200px","height","40px"],["role","status",1,"spinner-border","text-success",2,"width","24px","height","24px"],[1,"visually-hidden"]],template:function(e,n){e&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),m(3,"app-navbar"),o()(),r(4,"div",1)(5,"div",3),m(6,"app-admin-sidebar"),o(),r(7,"div",4)(8,"h2"),a(9,"Create New Product"),o(),r(10,"form",5),f("ngSubmit",function(){return n.onSubmit()}),r(11,"div",6)(12,"label",7),a(13,"Name"),o(),r(14,"div",8),m(15,"input",9),o()(),r(16,"div",6)(17,"label",10),a(18,"Price"),o(),r(19,"div",8),m(20,"input",11),o()(),r(21,"div",6)(22,"label",12),a(23,"Description"),o(),r(24,"div",8),m(25,"textarea",13),o()(),r(26,"div",6)(27,"label",14),a(28,"Category"),o(),r(29,"div",8)(30,"select",15),f("change",function(l){return n.onCategoryChanged(l)}),u(31,re,2,2,"option",16),o()()(),r(32,"div",6)(33,"label",17),a(34,"Images"),o(),r(35,"div",8)(36,"input",18),f("change",function(l){return n.onImageSelected(l)}),o()()(),u(37,ne,3,1,"div",19),r(38,"div",20),u(39,ae,2,1,"button",21)(40,ce,4,0,"div",22),o()()()()()),e&2&&(s(10),c("formGroup",n.myForm),s(21),c("ngForOf",n.categories),s(6),c("ngIf",n.imagePreviews.length>0),s(2),c("ngIf",!n.loading),s(),c("ngIf",n.loading))},dependencies:[T,W,y,M,j,J,k,z,U,V,q,L,D,R,X,$,G,B],styles:[".btn-remove[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff;border:none;font-size:12px;width:25px;height:25px;border-radius:20%;display:flex;align-items:center;justify-content:center;padding:0;transition:background-color .3s ease}.btn-remove[_ngcontent-%COMP%]:hover{background-color:#4caf50;color:#fff}[_ngcontent-%COMP%]::selection{background-color:#5c615c;color:#fff}"]})};var se=[{path:"",component:S}],C=class i{static \u0275fac=function(e){return new(e||i)};static \u0275mod=b({type:i});static \u0275inj=v({imports:[_.forChild(se),_]})};var Z=class i{static \u0275fac=function(e){return new(e||i)};static \u0275mod=b({type:i});static \u0275inj=v({imports:[y,C]})};export{Z as AddProductsModule};
