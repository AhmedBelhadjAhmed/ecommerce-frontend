import{a as Z}from"./chunk-Z7JX7RS7.js";import{a as oe}from"./chunk-KACECMBE.js";import{a as q,c as G,e as H,k as J,l as K,p as X}from"./chunk-WMSCIBPS.js";import{a as ee}from"./chunk-VR3MZZWK.js";import{a as U}from"./chunk-ZH3L7T54.js";import{l as W,o as P}from"./chunk-MLHW3EEE.js";import{$ as M,Ba as s,Ca as O,Oa as m,Ra as l,S as _,Ta as n,Ua as i,Ub as V,Va as g,Vb as Y,Wa as I,Xa as u,Xb as z,Ya as f,Za as L,Zb as v,aa as b,cb as k,db as c,e as re,eb as h,fb as N,gb as T,ha as y,hb as D,ia as S,ib as F,jb as $,lb as B,mb as j,nb as E,ob as A,pb as R,sb as Q,ya as w}from"./chunk-5XN3BUNB.js";var p=re(oe());var ce=()=>[],se=r=>["/detailsProduct",r],le=r=>["/updateProduct",r];function ae(r,o){r&1&&(n(0,"div",19)(1,"div",20)(2,"span",21),c(3,"Loading..."),i()()())}function de(r,o){r&1&&(n(0,"div",22),c(1," No products found. "),i())}function ue(r,o){if(r&1&&g(0,"img",30),r&2){let e=f().$implicit;L("alt",e.name),l("src",e.images[0],w)}}function pe(r,o){r&1&&(n(0,"span"),c(1,"No Image"),i())}function me(r,o){if(r&1){let e=I();n(0,"tr")(1,"td")(2,"input",25),u("change",function(a){let d=y(e).$implicit,ie=f(2);return S(ie.onProductSelect(a,d._id))}),i()(),n(3,"td"),c(4),i(),n(5,"td"),c(6),i(),n(7,"td"),c(8),A(9,"currency"),i(),n(10,"td"),c(11),i(),n(12,"td"),m(13,ue,1,2,"img",26)(14,pe,2,0,"ng-template",null,0,Q),i(),n(16,"td")(17,"button",27),c(18,"Details"),i(),n(19,"button",28),c(20,"Update"),i(),n(21,"button",29),u("click",function(){let a=y(e).$implicit,d=f(2);return S(d.onDelete(a._id))}),c(22,"Delete"),i()()()}if(r&2){let e=o.$implicit,t=k(15);s(2),l("value",e._id),s(2),h(e._id),s(2),h(e.name),s(2),h(R(9,9,e.price)),s(3),h((e.category==null?null:e.category.name)||"No Category"),s(2),l("ngIf",e.images&&e.images.length>0)("ngIfElse",t),s(4),l("routerLink",E(11,se,e._id)),s(2),l("routerLink",E(13,le,e._id))}}function ge(r,o){if(r&1&&(n(0,"table",23)(1,"thead")(2,"tr"),g(3,"th"),n(4,"th"),c(5,"ID"),i(),n(6,"th"),c(7,"Name"),i(),n(8,"th"),c(9,"Price"),i(),n(10,"th"),c(11,"Category"),i(),n(12,"th"),c(13,"Image"),i(),n(14,"th"),c(15,"Actions"),i()()(),n(16,"tbody"),m(17,me,23,15,"tr",24),i()()),r&2){let e=f();s(17),l("ngForOf",e.filteredProducts)}}function fe(r,o){if(r&1&&(n(0,"option",31),c(1),i()),r&2){let e=o.index;l("value",e+1),s(),N(" ",e+1," ")}}var x=class r{constructor(o){this.productService=o}products=[];filteredProducts=[];selectedProducts=[];searchQuery="";currentPage=1;totalPages=1;pageSize=5;getProducts$=null;deleteProduct$=null;searchProduct$=null;loading=!1;ngOnInit(){this.getProducts(this.currentPage)}ngOnDestroy(){this.unsubscribeAll()}unsubscribeAll(){this.getProducts$&&this.getProducts$.unsubscribe(),this.deleteProduct$&&this.deleteProduct$.unsubscribe(),this.searchProduct$&&this.searchProduct$.unsubscribe()}getProducts(o){this.loading=!0,this.getProducts$=this.productService.getProductsPagination(o,this.pageSize).subscribe({next:e=>{console.log("Paginated products:",e),this.products=e.products,this.filteredProducts=e.products,this.totalPages=e.totalPages,this.currentPage=e.currentPage,this.loading=!1},error:e=>{this.loading=!1,console.error("Error fetching paginated products",e)}})}onDelete(o){p.default.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(e=>{e.isConfirmed&&(this.deleteProduct$=this.productService.deleteProduct(o).subscribe({next:()=>{p.default.fire("Deleted!","The product has been deleted.","success").then(()=>{this.products=this.products.filter(t=>t._id!==o),this.filteredProducts=this.filteredProducts.filter(t=>t._id!==o)})},error:t=>{p.default.fire("Error!","There was an issue deleting the product.","error"),console.error("Error deleting product",t)}}))})}onDeleteMultiple(){p.default.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete selected!"}).then(o=>{o.isConfirmed&&this.selectedProducts.length>0&&this.productService.deleteMultipleProducts(this.selectedProducts).subscribe({next:()=>{p.default.fire("Deleted!","The selected products have been deleted.","success").then(()=>{this.getProducts(1)})},error:e=>{p.default.fire("Error!","There was an issue deleting the selected products.","error"),console.error("Error deleting products",e)}})})}onProductSelect(o,e){if(o.target.checked)this.selectedProducts.push(e);else{let t=this.selectedProducts.indexOf(e);t>-1&&this.selectedProducts.splice(t,1)}}onSearch(){this.searchQuery?this.searchProduct$=this.productService.searchProductsByName(this.searchQuery).subscribe({next:o=>{this.filteredProducts=o},error:o=>{console.error("Error searching products",o)}}):this.filteredProducts=this.products}onNextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.getProducts(this.currentPage))}onPreviousPage(){this.currentPage>1&&(this.currentPage--,this.getProducts(this.currentPage))}onSelectPage(o){let e=Number(o.target.value);e>=1&&e<=this.totalPages&&(this.currentPage=e,this.getProducts(this.currentPage))}static \u0275fac=function(e){return new(e||r)(O(Z))};static \u0275cmp=M({type:r,selectors:[["app-list-products"]],standalone:!0,features:[B],decls:31,vars:11,consts:[["noImage",""],[1,"container-fluid","p-0"],[1,"row","no-gutters"],[1,"col-12"],[1,"col-2"],[1,"col-10",2,"margin-top","70px"],[1,"row","mb-3"],[1,"col-auto"],["routerLink","/addProduct",1,"btn","btn-success"],[1,"btn","btn-danger",3,"click","disabled"],["type","text","placeholder","Search products by name...",1,"form-control",2,"width","200px",3,"ngModelChange","input","ngModel"],["class","d-flex justify-content-center align-items-center","style","height: 300px;",4,"ngIf"],["class","alert alert-success text-center mt-4",4,"ngIf"],["class","table table-striped table-hover",4,"ngIf"],[1,"pagination-controls","d-flex","align-items-center"],[1,"btn","btn-secondary",3,"click","disabled"],[1,"mx-2",2,"font-weight","bold","color","green"],[1,"form-select","mx-3",2,"width","auto",3,"change"],[3,"value",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-center","align-items-center",2,"height","300px"],["role","status",1,"spinner-border","text-success",2,"width","3rem","height","3rem"],[1,"visually-hidden"],[1,"alert","alert-success","text-center","mt-4"],[1,"table","table-striped","table-hover"],[4,"ngFor","ngForOf"],["type","checkbox",3,"change","value"],["style","width: 50px;",3,"src","alt",4,"ngIf","ngIfElse"],[1,"btn","btn-info","btn-sm",3,"routerLink"],[1,"btn","btn-warning","btn-sm",3,"routerLink"],[1,"btn","btn-danger","btn-sm",3,"click"],[2,"width","50px",3,"src","alt"],[3,"value"]],template:function(e,t){e&1&&(n(0,"div",1)(1,"div",2)(2,"div",3),g(3,"app-navbar"),i()(),n(4,"div",2)(5,"div",4),g(6,"app-admin-sidebar"),i(),n(7,"div",5)(8,"h2"),c(9,"Products List"),i(),n(10,"div",6)(11,"div",7)(12,"button",8),c(13,"Create New Product"),i()(),n(14,"div",7)(15,"button",9),u("click",function(){return t.onDeleteMultiple()}),c(16,"Delete Selected"),i()(),n(17,"div",7)(18,"input",10),$("ngModelChange",function(d){return F(t.searchQuery,d)||(t.searchQuery=d),d}),u("input",function(){return t.onSearch()}),i()()(),m(19,ae,4,0,"div",11)(20,de,2,0,"div",12)(21,ge,18,1,"table",13),n(22,"div",14)(23,"button",15),u("click",function(){return t.onPreviousPage()}),c(24,"Previous"),i(),n(25,"span",16),c(26),i(),n(27,"button",15),u("click",function(){return t.onNextPage()}),c(28,"Next"),i(),n(29,"select",17),u("change",function(d){return t.onSelectPage(d)}),m(30,fe,2,2,"option",18),i()()()()()),e&2&&(s(15),l("disabled",!t.selectedProducts.length),s(3),D("ngModel",t.searchQuery),s(),l("ngIf",t.loading),s(),l("ngIf",!t.loading&&t.filteredProducts.length===0),s(),l("ngIf",!t.loading&&t.filteredProducts.length>0),s(2),l("disabled",t.currentPage===1),s(3),T("Page ",t.currentPage," of ",t.totalPages,""),s(),l("disabled",t.currentPage===t.totalPages),s(3),l("ngForOf",j(10,ce).constructor(t.totalPages)))},dependencies:[U,ee,v,V,Y,z,X,J,K,q,G,H,P,W],styles:[".table[_ngcontent-%COMP%]{width:100%;margin-top:20px}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;text-align:left}.btn-success[_ngcontent-%COMP%]{background-color:#4caf50;border-color:#4caf50;color:#fff}.btn-info[_ngcontent-%COMP%]{background-color:#5bc0de;border-color:#46b8da;color:#fff}.btn-warning[_ngcontent-%COMP%]{background-color:#f0ad4e;border-color:#eea236;color:#fff}.btn-danger[_ngcontent-%COMP%]{background-color:#d9534f;border-color:#d43f3a;color:#fff}.btn[_ngcontent-%COMP%]{margin-right:5px}#createBtn[_ngcontent-%COMP%]{margin-bottom:20px}.table-hover[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{color:#09bd33}[_ngcontent-%COMP%]::selection{background-color:#5c615c;color:#fff}"]})};var he=[{path:"",component:x}],C=class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=b({type:r});static \u0275inj=_({imports:[P.forChild(he),P]})};var ne=class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=b({type:r});static \u0275inj=_({imports:[v,C]})};export{ne as ListProductsModule};
