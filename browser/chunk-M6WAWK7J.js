import{a as K}from"./chunk-KACECMBE.js";import{a as V,c as W,e as Y,p as z}from"./chunk-WMSCIBPS.js";import{a as q}from"./chunk-VR3MZZWK.js";import{a as k}from"./chunk-B5HR5V7T.js";import{a as P}from"./chunk-ZH3L7T54.js";import{o as U}from"./chunk-MLHW3EEE.js";import{$ as M,Ba as o,Ca as N,Oa as b,Ra as m,S as c,Ta as i,Ua as t,Ub as B,Va as u,Vb as j,Wa as T,Wb as R,Xa as S,Ya as _,Zb as f,aa as p,db as r,e as J,eb as l,g as E,ha as I,hb as A,ia as w,ib as D,jb as F,lb as O,ob as C,qb as y,ya as L}from"./chunk-5XN3BUNB.js";var h=J(K());function Q(s,n){s&1&&(i(0,"div",10)(1,"div",11)(2,"span",12),r(3,"Loading..."),t()()())}function X(s,n){s&1&&(i(0,"div",13),r(1," No users found. "),t())}function Z(s,n){if(s&1){let e=T();i(0,"tr")(1,"td"),u(2,"img",16),t(),i(3,"td"),r(4),t(),i(5,"td"),r(6),t(),i(7,"td"),r(8),t(),i(9,"td"),r(10),t(),i(11,"td"),r(12),C(13,"date"),t(),i(14,"td"),r(15),C(16,"date"),t(),i(17,"td")(18,"button",17),S("click",function(){let x=I(e).$implicit,d=_(2);return w(d.confirmDelete(x._id))}),r(19," Delete "),t()()()}if(s&2){let e=n.$implicit;o(2),m("src",e.avatar||"https://via.placeholder.com/50",L),o(2),l(e.firstname),o(2),l(e.lastname),o(2),l(e.email),o(2),l(e.role),o(2),l(y(13,7,e.createdAt,"short")),o(3),l(y(16,10,e.updatedAt,"short"))}}function $(s,n){if(s&1&&(i(0,"table",14)(1,"thead")(2,"tr")(3,"th"),r(4,"Avatar"),t(),i(5,"th"),r(6,"First Name"),t(),i(7,"th"),r(8,"Last Name"),t(),i(9,"th"),r(10,"Email"),t(),i(11,"th"),r(12,"Role"),t(),i(13,"th"),r(14,"Created At"),t(),i(15,"th"),r(16,"Updated At"),t(),i(17,"th"),r(18,"Actions"),t()()(),i(19,"tbody"),b(20,Z,20,13,"tr",15),t()()),s&2){let e=_();o(20),m("ngForOf",e.users)}}var g=class s{constructor(n){this.usersService=n}users=[];searchTerm="";loading=!0;subscription=new E;ngOnInit(){this.fetchUsers()}fetchUsers(){this.loading=!0,this.subscription.add(this.usersService.getAllUsersExceptAdmin().subscribe({next:n=>{this.users=n,this.loading=!1},error:n=>{console.error("Error fetching users:",n),this.loading=!1}}))}searchUsers(){this.searchTerm?(this.loading=!0,this.subscription.add(this.usersService.searchUsersByName(this.searchTerm).subscribe({next:n=>{this.users=n,this.loading=!1},error:n=>{console.error("Search failed:",n),this.loading=!1,n.status===404&&(this.users=[])}}))):this.fetchUsers()}confirmDelete(n){h.default.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(e=>{e.isConfirmed&&this.deleteUser(n)})}deleteUser(n){this.subscription.add(this.usersService.deleteUser(n).subscribe({next:()=>{h.default.fire("Deleted!","User has been deleted.","success").then(()=>{this.users=this.users.filter(e=>e._id!==n)})},error:e=>{console.error("Failed to delete user:",e),h.default.fire("Error!","Failed to delete user.","error")}}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(e){return new(e||s)(N(k))};static \u0275cmp=M({type:s,selectors:[["app-list-users"]],standalone:!0,features:[O],decls:15,vars:4,consts:[[1,"container-fluid","p-0"],[1,"row","no-gutters"],[1,"col-12"],[1,"col-2"],[1,"col-10",2,"margin-top","70px"],[1,"form-group","mb-3"],["type","text","placeholder","Search by name",1,"form-control",2,"width","300px",3,"ngModelChange","ngModel"],["class","d-flex justify-content-center align-items-center","style","height: 300px;",4,"ngIf"],["class","alert alert-success text-center mt-4",4,"ngIf"],["class","table table-striped",4,"ngIf"],[1,"d-flex","justify-content-center","align-items-center",2,"height","300px"],["role","status",1,"spinner-border","text-success",2,"width","3rem","height","3rem"],[1,"visually-hidden"],[1,"alert","alert-success","text-center","mt-4"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],["alt","Avatar",2,"width","50px","height","50px","border-radius","50%",3,"src"],[1,"btn","btn-danger","btn-sm",3,"click"]],template:function(e,a){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),u(3,"app-navbar"),t()(),i(4,"div",1)(5,"div",3),u(6,"app-admin-sidebar"),t(),i(7,"div",4)(8,"h2"),r(9,"User List"),t(),i(10,"div",5)(11,"input",6),F("ngModelChange",function(d){return D(a.searchTerm,d)||(a.searchTerm=d),d}),S("ngModelChange",function(){return a.searchUsers()}),t()(),b(12,Q,4,0,"div",7)(13,X,2,0,"div",8)(14,$,21,1,"table",9),t()()()),e&2&&(o(11),A("ngModel",a.searchTerm),o(),m("ngIf",a.loading),o(),m("ngIf",!a.loading&&a.users.length===0),o(),m("ngIf",!a.loading&&a.users.length>0))},dependencies:[P,q,f,B,j,R,z,V,W,Y],styles:["[_ngcontent-%COMP%]::selection{background-color:#5c615c;color:#fff}"]})};var ee=[{path:"",component:g}],v=class s{static \u0275fac=function(e){return new(e||s)};static \u0275mod=p({type:s});static \u0275inj=c({imports:[U.forChild(ee),U]})};var H=class s{static \u0275fac=function(e){return new(e||s)};static \u0275mod=p({type:s});static \u0275inj=c({imports:[f,v]})};export{H as ListUsersModule};
