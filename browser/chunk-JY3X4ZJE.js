import{a as K}from"./chunk-KACECMBE.js";import{a as j,b as d,c as q,d as A,f as G,h as L,i as B,o as U,q as z}from"./chunk-WMSCIBPS.js";import{a as D}from"./chunk-HGUX4EP4.js";import{a as T}from"./chunk-ZH3L7T54.js";import{k as O,o as R}from"./chunk-MLHW3EEE.js";import{$ as E,Ba as l,Ca as h,Oa as _,Ra as m,S as v,Ta as i,Ua as r,Va as p,Vb as k,Wa as P,Xa as f,Ya as y,Za as S,Zb as C,aa as w,cb as N,db as s,e as J,eb as V,ha as c,ia as u,lb as M,ya as I}from"./chunk-5XN3BUNB.js";var g=J(K());function Q(n,e){n&1&&(i(0,"div",24),s(1," Please enter a valid email address. "),r())}function W(n,e){if(n&1){let t=P();i(0,"div",25),p(1,"img",26),i(2,"button",27),f("click",function(){c(t);let a=y(),b=N(36);return u(a.removeImage(b))}),s(3,"X"),r()()}if(n&2){let t=y();l(),m("src",t.filePreview,I)}}function Z(n,e){if(n&1&&(i(0,"button",28),s(1," Register "),r()),n&2){let t=y();m("disabled",t.registerForm.invalid)}}function $(n,e){n&1&&(i(0,"div",29)(1,"span",30),s(2,"Loading..."),r()())}var x=class n{constructor(e,t,o){this.fb=e;this.authService=t;this.router=o;this.registerForm=this.fb.group({firstname:["",[d.required]],lastname:["",[d.required]],email:["",[d.required,d.email]],password:["",[d.required]],confirmPassword:["",[d.required]],role:["client"],avatar:[null]})}registerForm;selectedFile=null;filePreview=null;passwordVisible=!1;confirmPasswordVisible=!1;loading=!1;subscription;togglePasswordVisibility(e){e==="password"?this.passwordVisible=!this.passwordVisible:e==="confirmPassword"&&(this.confirmPasswordVisible=!this.confirmPasswordVisible)}onFileSelected(e){let t=e.target.files[0];if(t){this.selectedFile=t;let o=new FileReader;o.onload=a=>{this.filePreview=a.target.result},o.readAsDataURL(t)}}removeImage(e){this.selectedFile=null,this.filePreview=null,this.registerForm.patchValue({avatar:null}),e&&(e.value="")}onSubmit(){if(this.registerForm.invalid){g.default.fire("Error","Please fill all required fields correctly","error");return}if(this.registerForm.get("password")?.value!==this.registerForm.get("confirmPassword")?.value){g.default.fire("Error","Passwords do not match","error");return}let e=new FormData;e.append("firstname",this.registerForm.get("firstname")?.value),e.append("lastname",this.registerForm.get("lastname")?.value),e.append("email",this.registerForm.get("email")?.value),e.append("password",this.registerForm.get("password")?.value),e.append("role",this.registerForm.get("role")?.value),this.selectedFile&&e.append("avatar",this.selectedFile),this.loading=!0,this.subscription=this.authService.registerUser(e).subscribe({next:t=>{g.default.fire("Success","Registration successful","success").then(()=>this.router.navigate(["login"])),this.registerForm.reset(),this.removeImage(null),this.loading=!1},error:t=>{this.loading=!1,t.error.error.includes("users_email_key")?g.default.fire("Error","Email is already registered","error"):g.default.fire("Error",t.error.error||"Registration failed","error")}})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}static \u0275fac=function(t){return new(t||n)(h(U),h(D),h(O))};static \u0275cmp=E({type:n,selectors:[["app-register"]],standalone:!0,features:[M],decls:41,vars:9,consts:[["fileInput",""],[1,"container","mt-5",2,"margin-top","70px"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","firstname",1,"form-label"],["type","text","id","firstname","formControlName","firstname","placeholder","First Name",1,"form-control"],["for","lastname",1,"form-label"],["type","text","id","lastname","formControlName","lastname","placeholder","Last Name",1,"form-control"],["for","email",1,"form-label"],["type","email","id","email","formControlName","email","placeholder","exemple@exemple.exemple",1,"form-control"],["class","alert alert-danger",4,"ngIf"],[1,"mb-3","position-relative"],["for","password",1,"form-label"],["id","password","formControlName","password","placeholder","Password",1,"form-control",2,"padding-right","3rem",3,"type"],["type","button",1,"btn","position-absolute",2,"top","70%","right","0.75rem","transform","translateY(-50%)","padding","0","border","none","background","transparent","display","flex","align-items","center","justify-content","center","cursor","pointer",3,"click"],[1,"material-icons"],["for","confirmPassword",1,"form-label"],["id","confirmPassword","formControlName","confirmPassword","placeholder","Confirm Password",1,"form-control",2,"padding-right","3rem",3,"type"],["for","avatar",1,"form-label"],["type","file","id","avatar","accept","image/*",1,"form-control",3,"change"],["class","image-preview-container mt-2 position-relative",4,"ngIf"],[1,"d-flex","justify-content-center","align-items-center"],["type","submit","class","btn btn-primary custom-button",3,"disabled",4,"ngIf"],["class","spinner-border text-success","role","status",4,"ngIf"],[1,"alert","alert-danger"],[1,"image-preview-container","mt-2","position-relative"],[1,"img-thumbnail",2,"width","150px","height","150px",3,"src"],["type","button",1,"btn","btn-danger","btn-sm","close-button",3,"click"],["type","submit",1,"btn","btn-primary","custom-button",3,"disabled"],["role","status",1,"spinner-border","text-success"],[1,"visually-hidden"]],template:function(t,o){if(t&1){let a=P();p(0,"app-navbar"),i(1,"div",1)(2,"h2"),s(3,"Register"),r(),i(4,"form",2),f("ngSubmit",function(){return c(a),u(o.onSubmit())}),i(5,"div",3)(6,"label",4),s(7,"First Name"),r(),p(8,"input",5),r(),i(9,"div",3)(10,"label",6),s(11,"Last Name"),r(),p(12,"input",7),r(),i(13,"div",3)(14,"label",8),s(15,"Email"),r(),p(16,"input",9),_(17,Q,2,0,"div",10),r(),i(18,"div",11)(19,"label",12),s(20,"Password"),r(),p(21,"input",13),i(22,"button",14),f("click",function(){return c(a),u(o.togglePasswordVisibility("password"))}),i(23,"span",15),s(24),r()()(),i(25,"div",11)(26,"label",16),s(27,"Confirm Password"),r(),p(28,"input",17),i(29,"button",14),f("click",function(){return c(a),u(o.togglePasswordVisibility("confirmPassword"))}),i(30,"span",15),s(31),r()()(),i(32,"div",3)(33,"label",18),s(34,"Avatar"),r(),i(35,"input",19,0),f("change",function(H){return c(a),u(o.onFileSelected(H))}),r(),_(37,W,4,1,"div",20),r(),i(38,"div",21),_(39,Z,2,1,"button",22)(40,$,3,0,"div",23),r()()()}if(t&2){let a;l(4),m("formGroup",o.registerForm),l(13),m("ngIf",((a=o.registerForm.get("email"))==null?null:a.invalid)&&((a=o.registerForm.get("email"))==null?null:a.touched)),l(4),S("type",o.passwordVisible?"text":"password"),l(3),V(o.passwordVisible?"visibility_off":"visibility"),l(4),S("type",o.confirmPasswordVisible?"text":"password"),l(3),V(o.confirmPasswordVisible?"visibility_off":"visibility"),l(6),m("ngIf",o.filePreview),l(2),m("ngIf",!o.loading),l(),m("ngIf",o.loading)}},dependencies:[T,z,G,j,q,A,L,B,C,k],styles:[".container[_ngcontent-%COMP%]{max-width:600px}img[_ngcontent-%COMP%]{margin-top:10px;margin-right:10px;display:block}button.btn-danger[_ngcontent-%COMP%]{display:block;margin-top:10px}.image-preview-container[_ngcontent-%COMP%]{display:inline-block;position:relative}.close-button[_ngcontent-%COMP%]{position:absolute;top:5px;right:5px;z-index:10}.custom-button[_ngcontent-%COMP%]{background-color:#0b9310}.custom-button[_ngcontent-%COMP%]:hover{background-color:#45a049}input[_ngcontent-%COMP%]::selection{background-color:#009024;color:#fff}.container[_ngcontent-%COMP%]{padding-top:70px}[_ngcontent-%COMP%]::selection{background-color:#5c615c;color:#fff}"]})};var ee=[{path:"",component:x}],F=class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=w({type:n});static \u0275inj=v({imports:[R.forChild(ee),R]})};var Y=class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=w({type:n});static \u0275inj=v({imports:[C,F]})};export{Y as RegisterModule};
