import{a as Y}from"./chunk-TA5CI7RB.js";import{a as $}from"./chunk-Z7JX7RS7.js";import{a as J}from"./chunk-KACECMBE.js";import{a as z}from"./chunk-HGUX4EP4.js";import{a as B}from"./chunk-ZH3L7T54.js";import{i as L,l as U,o as u}from"./chunk-MLHW3EEE.js";import{$ as O,Ba as c,Ca as m,Oa as f,Ra as l,S as g,Ta as r,Tb as N,Ua as t,Ub as j,Va as x,Vb as A,Wa as F,Xa as E,Xb as V,Ya as p,Zb as h,aa as v,cb as M,db as n,e as H,eb as w,fb as d,ha as S,ia as P,lb as k,ob as R,pb as T,sb as D,ya as y}from"./chunk-5XN3BUNB.js";var _=H(J());function K(o,i){if(o&1){let e=F();r(0,"div")(1,"p")(2,"strong"),n(3,"Product ID:"),t(),n(4),t(),r(5,"p")(6,"strong"),n(7,"Name:"),t(),n(8),t(),r(9,"p")(10,"strong"),n(11,"Price:"),t(),n(12),R(13,"currency"),t(),r(14,"p")(15,"strong"),n(16,"Description:"),t(),r(17,"span",9),n(18),t()(),r(19,"p")(20,"strong"),n(21,"Category:"),t(),n(22),t(),r(23,"div",10)(24,"button",11),E("click",function(){S(e);let s=p();return P(s.addToFavorites())}),r(25,"span",6),n(26),t(),n(27),t()()()}if(o&2){let e=p();c(4),d(" ",e.product._id,""),c(4),d(" ",e.product.name,""),c(4),d(" ",T(13,8,e.product.price),""),c(6),w(e.product.description),c(4),d(" ",e.product.category==null?null:e.product.category.name,""),c(2),l("ngClass",e.isFavorite?"btn-danger":"btn-success"),c(2),d(" ",e.isFavorite?"delete":"favorite_border"," "),c(),d(" ",e.isFavorite?"Remove from My Favorites":"Add to My Favorites"," ")}}function Q(o,i){o&1&&(r(0,"p"),n(1,"Loading product details..."),t())}function W(o,i){if(o&1){let e=F();r(0,"div",16),E("click",function(){let s=S(e).$implicit,I=p(2);return P(I.onImageClick(s))}),x(1,"img",17),t()}if(o&2){let e=i.$implicit;c(),l("src",e,y)}}function X(o,i){if(o&1&&(r(0,"div")(1,"div",12),x(2,"img",13),t(),r(3,"h4"),n(4,"Images:"),t(),r(5,"div",14),f(6,W,2,1,"div",15),t()()),o&2){let e=p();c(2),l("src",e.selectedImage,y),c(4),l("ngForOf",e.product.images)}}function Z(o,i){o&1&&(r(0,"p"),n(1,"No images available for this product."),t())}var C=class o{constructor(i,e,a,s){this.productService=i;this.favoriteService=e;this.authService=a;this.route=s}product;productSubscription;selectedImage;isFavorite=!1;ngOnInit(){let i=this.route.snapshot.paramMap.get("id");this.loadProductDetails(i),this.checkIfFavorite(i)}loadProductDetails(i){this.productSubscription=this.productService.getProductById(i).subscribe({next:e=>{this.product=e,this.product.images&&this.product.images.length>0&&(this.selectedImage=this.product.images[0])},error:e=>{console.error("Error fetching product",e)}})}checkIfFavorite(i){let e=this.authService.extractIdFromToken();console.log("Checking favorites for user ID:",e),e?this.favoriteService.getAllFavorites(e).subscribe({next:a=>{console.log("Fetched favorites:",a),console.log("Product ID to check:",i),this.isFavorite=a.some(s=>(console.log("Favorite product ID:",s.product._id),s.product._id===i)),console.log("Is product favorite:",this.isFavorite)},error:a=>{console.error("Error fetching favorites:",a)}}):console.log("User is not logged in, cannot check favorites.")}onImageClick(i){this.selectedImage=i}addToFavorites(){let i=this.authService.extractIdFromToken(),e=localStorage.getItem("userRole");if(!i||e==="admin"){_.default.fire({icon:"error",title:"Oops...",text:"You need to log in first !"});return}this.favoriteService.createOrDeleteFavorite(i,this.product._id).subscribe({next:a=>{this.isFavorite=!this.isFavorite,_.default.fire({icon:"success",title:"Success",text:this.isFavorite?"Product added to favorites!":"Product removed from favorites!"})},error:a=>{console.error("Error updating favorites",a),_.default.fire({icon:"error",title:"Oops...",text:"Something went wrong while updating favorites!"})}})}ngOnDestroy(){this.productSubscription&&this.productSubscription.unsubscribe()}static \u0275fac=function(e){return new(e||o)(m($),m(Y),m(z),m(L))};static \u0275cmp=O({type:o,selectors:[["app-client-details-product"]],standalone:!0,features:[k],decls:17,vars:4,consts:[["loading",""],["noImages",""],[1,"container","mt-5",2,"padding-top","100px"],[1,"row","justify-content-between",2,"margin-left","15px","margin-right","15px"],[1,"col-md-6"],["routerLink","/our-products",1,"btn","btn-secondary"],[1,"material-icons","me-2",2,"vertical-align","middle"],[2,"margin-top","50px"],[4,"ngIf","ngIfElse"],[1,"card-text"],[1,"mt-3"],[1,"btn",3,"click","ngClass"],[1,"main-image"],["alt","Selected Product Image",1,"img-fluid",3,"src"],[1,"thumbnails"],["class","thumbnail",3,"click",4,"ngFor","ngForOf"],[1,"thumbnail",3,"click"],["alt","Product Thumbnail",1,"img-thumbnail",2,"max-width","80px","max-height","80px","cursor","pointer","margin-right","10px",3,"src"]],template:function(e,a){if(e&1&&(x(0,"app-navbar"),r(1,"div",2)(2,"div",3)(3,"div",4)(4,"a",5)(5,"span",6),n(6,"arrow_back"),t(),n(7," Return to our products "),t(),r(8,"h2",7),n(9,"Product Details"),t(),f(10,K,28,10,"div",8)(11,Q,2,0,"ng-template",null,0,D),t(),r(13,"div",4),f(14,X,7,2,"div",8)(15,Z,2,0,"ng-template",null,1,D),t()()()),e&2){let s=M(12),I=M(16);c(10),l("ngIf",a.product)("ngIfElse",s),c(4),l("ngIf",(a.product==null?null:a.product.images)&&a.product.images.length>0)("ngIfElse",I)}},dependencies:[B,h,N,j,A,V,u,U],styles:[".main-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:1px solid #ddd;padding:10px;max-width:400px;height:auto;margin-bottom:20px}.thumbnails[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{display:inline-block;margin-bottom:10px}.thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:1px solid #ddd;padding:5px;cursor:pointer;max-width:80px;max-height:80px}.thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{border-color:#007bff}.col-md-6[_ngcontent-%COMP%]{padding:15px}.btn-success[_ngcontent-%COMP%]{margin-top:15px}.material-icons[_ngcontent-%COMP%]{vertical-align:middle}.card-text[_ngcontent-%COMP%]{white-space:normal;overflow-wrap:break-word;max-width:90%}h2[_ngcontent-%COMP%], h4[_ngcontent-%COMP%]{margin-bottom:10px}[_ngcontent-%COMP%]::selection{background-color:#5c615c;color:#fff}"]})};var ee=[{path:"",component:C}],b=class o{static \u0275fac=function(e){return new(e||o)};static \u0275mod=v({type:o});static \u0275inj=g({imports:[u.forChild(ee),u]})};var G=class o{static \u0275fac=function(e){return new(e||o)};static \u0275mod=v({type:o});static \u0275inj=g({imports:[h,b]})};export{G as ClientDetailsProductModule};
